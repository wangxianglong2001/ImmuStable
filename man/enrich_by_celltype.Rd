% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrich_by_celltype.R
\name{enrich_by_celltype}
\alias{enrich_by_celltype}
\title{Pathway enrichment analysis by cell type using Z-score matrix}
\usage{
enrich_by_celltype(
  zscore_mat,
  out_prefix = NULL,
  min_genes_for_enrich = 3,
  kegg_pcutoff = 0.05,
  go_pcutoff = 0.05,
  analysis_type = c("all", "KEGG", "GO", "BP", "CC", "MF")
)
}
\arguments{
\item{zscore_mat}{A numeric matrix of Z-scores (genes x cell types).}

\item{out_prefix}{Optional character string. Prefix for output Excel file.
If NULL, results are returned in R only.}

\item{min_genes_for_enrich}{Minimum number of genes required to run enrichment
(default: 3).}

\item{kegg_pcutoff}{Numeric. P-value cutoff for KEGG enrichment (default: 0.05).}

\item{go_pcutoff}{Numeric. P-value cutoff for GO enrichment (default: 0.05).}

\item{analysis_type}{Character vector specifying enrichment types. Options:
\code{"all"}, \code{"KEGG"}, \code{"GO"}, \code{"BP"}, \code{"CC"}, \code{"MF"}.
Default: \code{c("all","KEGG","GO","BP","CC","MF")}.}
}
\value{
A list containing enrichment results for each cell type. If
  \code{out_prefix} is provided, an Excel file is also saved.
}
\description{
This function performs KEGG and GO enrichment analysis for each cell type
based on up- and down-regulated genes identified from a Z-score matrix.
Results include statistics, mapping tables, and enrichment outputs, with
optional saving to Excel.
}
\details{
For each cell type:
\enumerate{
  \item Identify up- and down-regulated genes (Z-score > 2 or < -2).
  \item Map ENSEMBL IDs to SYMBOLs, then to ENTREZ IDs.
  \item Perform KEGG enrichment (via \pkg{clusterProfiler}).
  \item Perform GO enrichment (BP, CC, MF) using \pkg{clusterProfiler}.
  \item Collect statistics and optionally save results to Excel.
}
}
\examples{
\dontrun{
res <- enrich_by_celltype(zscore_mat,
                          out_prefix = "output",
                          analysis_type = c("KEGG","GO"))
}

}
