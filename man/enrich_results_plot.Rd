% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/enrich_results_plot.R
\name{enrich_results_plot}
\alias{enrich_results_plot}
\title{Plot enrichment results for a given cell type}
\usage{
enrich_results_plot(
  res,
  celltype = NULL,
  direction = c("up", "down"),
  which = c("KEGG", "BP", "CC", "MF"),
  top_n = 20,
  title = NULL,
  enrichment_col = c("FoldEnrichment", "RichFactor"),
  qvalue_col = c("qvalue", "p.adjust", "pvalue"),
  geneid_col = c("Description", "ID"),
  list_count_col = c("Count", "GeneRatio", "BgRatio")
)
}
\arguments{
\item{res}{A result list from \code{enrich_by_celltype}, or a compatible
list structure containing enrichment results.}

\item{celltype}{Character string. The cell type to plot (must exist in \code{res}).}

\item{direction}{Character. Either \code{"up"} or \code{"down"} (default: both options).}

\item{which}{Character vector. Which enrichment types to plot. Options:
\code{"KEGG"}, \code{"BP"}, \code{"CC"}, \code{"MF"}.}

\item{top_n}{Integer. Number of top terms to display (default: 20).}

\item{title}{Optional character string. Plot title. If NULL, no title is shown.}

\item{enrichment_col}{Candidate column names for enrichment score
(default: \code{c("FoldEnrichment","RichFactor")}).}

\item{qvalue_col}{Candidate column names for q-value or adjusted p-value
(default: \code{c("qvalue","p.adjust","pvalue")}).}

\item{geneid_col}{Candidate column names for term description or ID
(default: \code{c("Description","ID")}).}

\item{list_count_col}{Candidate column names for gene counts
(default: \code{c("Count","GeneRatio","BgRatio")}).}
}
\value{
A list of plots for each enrichment type requested. Each element
  contains:
  \itemize{
    \item \code{dot}: ggplot2 dot plot
    \item \code{bar}: ggplot2 bar plot
    \item \code{df}: processed data frame used for plotting
  }
}
\description{
This function generates dot plots and bar plots for enrichment results
(KEGG or GO categories) from the output of \code{enrich_by_celltype}.
It supports flexible column naming and automatically detects enrichment
score, q-value, and gene count columns.
}
\details{
The function:
\enumerate{
  \item Extracts enrichment results for the specified cell type and direction.
  \item Detects enrichment score, q-value, and gene count columns.
  \item Prepares a ranked data frame of top terms.
  \item Generates dot and bar plots with ggplot2.
}
}
\examples{
\dontrun{
plots <- enrich_results_plot(res,
                             celltype = "B cells",
                             direction = "up",
                             which = c("KEGG","BP"),
                             top_n = 15)
plots$KEGG$dot
plots$BP$bar
}

}
