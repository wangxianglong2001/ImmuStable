% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_zscore.R
\name{compute_zscore}
\alias{compute_zscore}
\title{Compute Z-score for Seurat object against reference database}
\usage{
compute_zscore(
  seurat_obj,
  celltype_col,
  assay = "RNA",
  use_layer = NULL,
  wt_ref = NULL,
  save_path = NULL
)
}
\arguments{
\item{seurat_obj}{A Seurat object containing single-cell expression data.}

\item{celltype_col}{Character string. Column name in `seurat_obj@meta.data` that
specifies cell type annotations.}

\item{assay}{Character string. Assay to use (default: "RNA").}

\item{use_layer}{Optional. Layer name in the assay to extract expression data from.
If NULL, the "data" slot is used.}

\item{wt_ref}{A data.frame reference database with required columns:
\code{Gene}, \code{CellType}, \code{ref_mean}, \code{ref_sd}.
If NULL, the function will look for `WT_database_data` in the global environment.}

\item{save_path}{Optional. File path to save results. If provided, results will be
written to Excel (if \pkg{openxlsx} is available) or CSV files.}
}
\value{
A numeric matrix of Z-scores (genes x cell types).
}
\description{
This function calculates average gene expression per cell type in a Seurat object,
compares it with a reference database, and computes Z-scores. Optionally, results
can be saved to Excel or CSV files.
}
\details{
The function:
\enumerate{
  \item Extracts expression matrix from the Seurat object.
  \item Computes mean expression per gene per cell type.
  \item Joins with reference database and calculates Z-scores.
  \item Classifies results into "Above", "Below", or "Within" database range.
  \item Optionally saves results to file.
}
}
\examples{
\dontrun{
zmat <- compute_zscore(seurat_obj, celltype_col = "celltype",
                       wt_ref = WT_database_data, save_path = "output")
}

}
